---
layout: post
current: post
cover: assets/study/study-2-2.png
navigation: True
title: 실전형 React Hooks 10개 (2) - UseEffect
date: 2021-08-08 02:01:01
tags: study
class: post-template
subclass: "post"
author: CodePurple
---

## UseEffect란?
useEffect는 `function, dependency`라는 두 개의 변수를 받는다. 여기서 `dependency`라는 변수는 말 그대로 해당 element에 변화가 발생하면 function을 발생시키는 친구라고 생각하면 된다.
<!--break-->

그래서 보통 useEffect(function, [dependency]) 이런 형태로 사용된다. `주의할 점`은 빈 array []의 경우 한 번만 실행되고 어떤 변화에도 재실행되지 않는 경우에 사용한다.

## 사용 예시
### useTitle  
구현 기능 : 웹페이지의 title을 변경하는 기능

```javascript
const useTitle = (initialTitle) =>{
    const [title,setTitle] =useState(initialTitle);
    const updateTitle = () => {
        const htmlTitle = document.querySelector("title");
        htmlTitle.innerText = title;
    };
    useEffect(updateTitle, [title]);
    return setTitle;
}

const App = () => {
    const titleUpdater = useTitle("Loading...");
    setTimeout(()=>titleUpdater("Home"),5000);
}
```

코드 설명
1. useTitle 함수에서 받는 string이 initialTitle
2. updateTitle이 웹의 title 수정
3. titleUpdater에서 useTitle의 initialTitle에 "Loading" 전달
4. titleUpdater에서 5초 후에 "Home" 전달
5. useTitle 함수에서 전달받은 initialTitle이 "Home"이 됬으니까 title이 바뀐 상황
6. useEffect 함수 실행

### useScroll
구현 기능 : scroll이 발생했을 때, 특정 범위를 만족하면 함수 실행
```javascript
const useScroll = () => {
    const [state, setState] = useState({
      x: 0,
      y: 0
    });
    const onScroll = () => {
      setState({ y: window.scrollY, x: window.screenX });
    };
    useEffect(() => {
      window.addEventListener("scroll", onScroll);
      return () => window.removeEventListener("scroll", onScroll);
    }, []);
    return state;
  };
```
코드 설명
1. window.scrollY를 통해 y 좌표값 측정 후 업데이트
2. addEventListener를 통해 `scroll` 이벤트 탐지 후 `onScroll` 함수 실행
3. return을 통해 뒷정리

사실 나는 여기서 `3번` 파트가 잘 이해가 되지는 않는다. component가 나타날때 useEffect가 실행되고 이후에 component가 사라질 때, clean-up 함수가( return에 들어가 있는 함수) 실행된다고 한다. 이 과정을 통해 불필요한 리소스 사용을 줄여 사이트 운용에 도움을 준다고 글을 읽은 적이 있으나 아직 그정도 규모의 프로젝트가 아니라서 그런지 체감이 크게 되지는 않는다. 하지만 이 부분에 대해 인지는 하고 있어야하니까 알아두면 좋을 것 같다.